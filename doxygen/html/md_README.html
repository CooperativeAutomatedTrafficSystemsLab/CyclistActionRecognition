<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Basic Movment Detection Based on Images/Image Sequences: Under Cosntruction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Basic Movment Detection Based on Images/Image Sequences
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Under Cosntruction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This repository is still under construction. Dataset and publication associated to the repository will be made public as soon as possible.</p>
<p>TODO: Add \ to bash lines</p>
<h1>Cyclist Action Recognition</h1>
<p>This repository contains code to train, validate, and test networks for cyclist action recognition based on image sequences, optical flow sequences, and trajectories. It was used to produce the results from <em>Image Sequence Based Cyclist Action Recognition Using Multi-Stream 3D Convolution</em> (link will be added soon).</p>
<h2>Motion Sequence Based Network</h2>
<h3>Prepare Dataset</h3>
<p>The dataset, including a short description of the dataset, can be found here (link will be added as soon as dataset is available). Since the dataset is rather larger (~63 GB), we need to create a numpy memory map first, so we don't need to load the complete dataset to memory (if you have enough memory, you can also load the complete dataset into your memory).</p>
<p>Download the dataset and extract it to a folder called dataset (e.g.: cyclist_action_recognition/dataset). Copy the split.json to the same folder. Make sure you have enough space on your hard drive. The dataset is compressed using 7zip. Extract it by (might take a while):</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cyclist_action_recognition/dataset$ 7z e of_smlr.7z</div></div><!-- fragment --><p>and run: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 ImageSequenceDataset/prepare_memmap/create_np_memmap.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--dataset_path PATH_TO_DATASET/cyclist_action_recognition/dataset</div></div><!-- fragment --><p> The dataset will be prepared as two numpy memory maps containing the network inputs for training and validation.</p>
<h3>Performing a Grid Search</h3>
<p>To perform a grid search, start <em>pipeline_motion_sequences/gridsearch_motion_sequences.py</em>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 pipeline_motion_sequences/gridsearch_motion_sequences.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition/ \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--json_path ./sweeps/wait_motion.json</div></div><!-- fragment --><p>The grid search will train a network for every configuration in <em>wait_motion.json</em> and add train and validation scores to tensorboard. Start tensorboard by:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;tensorboard --logdir=PATH_TO_DATASET/cyclist_action_recognition/trained_models</div></div><!-- fragment --><h3>Train Final Estimator</h3>
<p>To train the final estimator run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 pipeline_motion_sequences/train_final_estimator.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition/ \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--json_path ./final/wait_motion_final.json \</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;--steps NUMBER_OF_STEPS_TO_TRAIN</div></div><!-- fragment --><p>The estimator will be trained until step NUMBER_OF_STEPS_TO_TRAIN and the final checkpoint will be saved. This is the checkpoint used to create the test probabilities.</p>
<h3>Create Test Probabilities</h3>
<p>To create test probabilities run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 pipeline_motion_sequences/create_test_probs.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition/ \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--state_machine NAME_OF_STATE_MACHINE </div></div><!-- fragment --><p>The checkpoint file must be placed in <em>PATH_TO_DATASET/cyclist_action_recognition/trained_models/final/NAME_OF_STATE_MACHINE</em>. An output file <em>probs.npy</em> will be saved to the same folder.</p>
<h2>Trajectory Based Network</h2>
<p>The dataset, including a short description of the dataset, can be found here (link will be added as soon as dataset is available). Compared to the of dataset, the dataset is small, so we can load it directly to RAM.</p>
<p>Download the dataset and extract it to a folder called dataset (e.g.: cyclist_action_recognition_trajectory/dataset). Copy the split.json to the same folder.</p>
<h3>Performing a Grid Search</h3>
<p>To perform a grid search, start <em>pipeline_trajectory_based/gridsearch_trajectory_based.py</em>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 pipeline_trajectory_based/gridsearch_trajectory_based.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition_trajectory/ \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--json_path ./sweeps/wait_motion.json</div></div><!-- fragment --><p>The grid search will train a network for every configuration in <em>wait_motion.json</em> and add train and validation scores to tensorboard. Start tensorboard by:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;tensorboard --logdir=PATH_TO_DATASET/cyclist_action_recognition_trajectory/trained_models</div></div><!-- fragment --><h3>Train Final Estimator</h3>
<p>To train the final estimator run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 pipeline_trajectory_based/train_final_estimator_trajectory_based.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition_trajectory/ \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--json_path ./final/wait_motion_final.json \</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;--steps NUMBER_OF_STEPS_TO_TRAIN</div></div><!-- fragment --><p>The estimator will be trained until step NUMBER_OF_STEPS_TO_TRAIN and the final checkpoint will be saved. This is the checkpoint used to create the test probabilities.</p>
<h3>Create Test Probabilities</h3>
<p>To create test probabilities run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 pipeline_trajectory_based/create_test_probs.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition_trajectory/ \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--state_machine NAME_OF_STATE_MACHINE </div></div><!-- fragment --><p>The checkpoint file must be placed in <em>PATH_TO_DATASET/cyclist_action_recognition_trajectory/trained_models/final/NAME_OF_STATE_MACHINE</em>. An output file <em>probs.npy</em> will be saved to the same folder.</p>
<h2>Evaluate Results</h2>
<h3>Prepare Probabilities</h3>
<p>Prepare proabilities for evaluation script:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 BasicMovementDetectionEvaluation/create_evaluation_inputs.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition_trajectory/ \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--state_machine NAME_OF_STATE_MACHINE </div></div><!-- fragment --><h3>Create Evaluation</h3>
<p>To create evaluation results run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;python3 BasicMovementDetectionEvaluation/create_evaluation_inputs.py \</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;--networkPath PATH_TO_DATASET/cyclist_action_recognition_trajectory/final/wait_motion/wait_motion_eval_probs.npy \</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;--state_machine NAME_OF_STATE_MACHINE </div></div><!-- fragment --><p>The evaluation results will be created in the same folder. The script generate F1-scores, Brier-scores, confusion matrices, and Q-Q plots. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
